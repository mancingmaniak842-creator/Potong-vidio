name: YouTube Cut

on:
  workflow_dispatch:
    inputs:
      url:
        description: "YouTube URL"
        required: true
      start:
        description: "Start time (e.g. 00:01:23)"
        required: true
      end:
        description: "End time (e.g. 00:02:34)"
        required: true

jobs:
  cut:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Install tools
        run: |
          sudo apt update
          sudo apt install -y ffmpeg
          pip install yt-dlp

      - name: Download best quality
        run: |
          yt-dlp -f "bestvideo+bestaudio/best" -o "input.%(ext)s" "${{ github.event.inputs.url }}"

      - name: Cut & re-encode (CapCut friendly)
        run: |
          ffmpeg -i input.* \
            -ss "${{ github.event.inputs.start }}" \
            -to "${{ github.event.inputs.end }}" \
            -c:v libx264 -preset fast -crf 23 \
            -c:a aac -b:a 192k \
            -movflags +faststart \
            output.mp4

      - name: Upload output as artifact
        uses: actions/upload-artifact@v3
        with:
          name: youtube-cut
          path: output.mp4
